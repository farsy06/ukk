<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h4 class="mb-0"><i class="fas fa-hand-holding"></i> Ajukan Peminjaman Alat</h4>
            </div>
            <div class="card-body">
                <% if (typeof error !== 'undefined' && error) { %>
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <%= error %>
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                <% } %>

                <div class="row">
                    <div class="col-md-6">
                        <h5>Detail Alat</h5>
                        <% if (typeof alat !== 'undefined' && alat) { %>
                            <p><strong>Nama Alat:</strong> <%= alat.nama_alat %></p>
                            <p><strong>Kategori:</strong> <%= alat.kategori ? alat.kategori.nama_kategori : 'Tidak ada kategori' %></p>
                            <p><strong>Kondisi:</strong>
                                <% if (alat.kondisi === 'baik') { %>
                                    <span class="badge bg-success">Baik</span>
                                <% } else if (alat.kondisi === 'rusak_ringan') { %>
                                    <span class="badge bg-warning">Rusak Ringan</span>
                                <% } else if (alat.kondisi === 'rusak_berat') { %>
                                    <span class="badge bg-danger">Rusak Berat</span>
                                <% } %>
                            </p>
                            <p><strong>Status:</strong>
                                <% if (alat.status === 'tersedia') { %>
                                    <span class="badge bg-success">Tersedia</span>
                                <% } else if (alat.status === 'dipinjam') { %>
                                    <span class="badge bg-warning">Dipinjam</span>
                                <% } else if (alat.status === 'maintenance') { %>
                                    <span class="badge bg-secondary">Maintenance</span>
                                <% } %>
                            </p>
                        <% } %>
                    </div>
                    <div class="col-md-6">
                        <h5>Form Pengajuan Peminjaman</h5>
                        <form action="/peminjaman/ajukan" method="POST">
                            <% if (typeof alat !== 'undefined' && alat) { %>
                                <input type="hidden" name="alat_id" value="<%= alat.id %>">
                            <% } %>

                            <div class="mb-3">
                                <label for="tanggal_pinjam" class="form-label">Tanggal Pinjam</label>
                                <input type="date" class="form-control" id="tanggal_pinjam" name="tanggal_pinjam" required>
                            </div>

                            <div class="mb-3">
                                <label for="tanggal_kembali" class="form-label">Tanggal Kembali</label>
                                <input type="date" class="form-control" id="tanggal_kembali" name="tanggal_kembali" required>
                            </div>

                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-paper-plane"></i> Ajukan Peminjaman
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('tanggal_pinjam').addEventListener('change', function() {
    const tanggalPinjam = new Date(this.value);
    const tanggalKembali = new Date(tanggalPinjam);
    tanggalKembali.setDate(tanggalKembali.getDate() + 1); // Default 1 hari

    const formattedDate = tanggalKembali.toISOString().split('T')[0];
    document.getElementById('tanggal_kembali').value = formattedDate;
    document.getElementById('tanggal_kembali').min = this.value;
});
</script>
